#!/bin/bash

# For use with the `cdable_vars` option in bash, this script generates a file
# containing a bunch of definitions:
#
# export project="/path/to/project"
#
# which can then be sourced into an environment allowing me to type "cd
# project" and be taken to that project's directory from anywhere!
PROJECTS_DIR="${HOME}/Projects"
OUT_FILE="${HOME}/.bashrc.d/01-bookmarks"

if [ -f "${OUT_FILE}" ]; then
    rm "${OUT_FILE}"
fi

cat > "${OUT_FILE}" <<EOF
# vim: ft=bash
# This file was automatically generated by the "regen_bookmarks" script on: `date`
# DO NOT EDIT

EOF

# Create a "bookmark" for each top-level git repo in the projects dir.
for project in $(find $PROJECTS_DIR -maxdepth 2 -type d -name .git | sed s?/.git??)
do
    name=$(basename ${project} | sed s.-._.g)
    echo "export ${name}=\"${project}\"" >> "${OUT_FILE}"
done
